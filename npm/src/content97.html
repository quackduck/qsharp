<p>There are several types of measurements you can perform on an $n$-qubit system ($n&gt;1$):</p>
<ul>
<li>Measuring all the qubits simultaneously in an orthogonal basis ($2^n$ possible outcomes). As we shall see below, this is a direct generalization of orthogonal basis measurements done in single-qubit systems introduced in the previous kata.</li>
<li>Partial measurement: measuring $m$ qubits out of $n$, for $m&lt;n$ ($2^m$ possible outcomes). Partial measurements involve a partial collapse of the system&#39;s wave function, since only some of the qubits are measured.</li>
<li>Joint measurement: measuring a joint property of all $n$ qubits ($2$ possible outcomes).</li>
</ul>
<p>We will discuss these concepts in the same order as in the list above.</p>
<h2 id="full-measurements-measurements-in-multi-qubit-bases">Full Measurements: Measurements in Multi-Qubit Bases</h2>
<p>Consider a system consisting of $n\geq1$ qubits. The wave function of such a system belongs to a vector space of dimension $2^n$. Thus, the vector space is spanned by an orthogonal basis, such as the computational basis which consists of the vectors $|0\dotsc0\rangle, \dotsc, |1\dotsc 1\rangle$. For generality, we consider an arbitrary orthonormal basis, which we denote by ${ |b_0\rangle, |b_1\rangle, \dotsc, |b_{2^n-1}\rangle }$.</p>
<p>Then, the state $|\psi\rangle$ of the multi-qubit system can be expressed as a linear combination of the $2^n$ basis vectors $|b_i\rangle$. That is, there exist complex numbers $c_0,c_1,\dotsc, c_{2^n-1}$ such that</p>
<p>$$
|\psi\rangle = \sum_{i=0}^{2^n-1} c_i|b_i\rangle \equiv \begin{pmatrix} c_0 \\ c_1 \\ \vdots \\ c_{2^n-1} \end{pmatrix}
$$</p>
<p>In line with the usual convention, we choose the wave function to be normalized, so that $|c_0|^2 + \dotsc + |c_{2^n-1}|^2 =1$. Then, a quantum measurement in the ${ |b_0\rangle, |b_1\rangle, \dotsc, |b_{2^n-1}\rangle }$ basis satisfies the following rules:</p>
<ul>
<li>The measurement outcome $b_i$ occurs with probability $|c_i|^2$.</li>
<li>Whenever the measurement outcome is $b_i$, the wave function collapses to the state $|b_i\rangle$. That is, the post-measurement state of the system is equal to $|b_i\rangle$.</li>
</ul>
<p>This can be summarized in the following table:</p>
<table>
    <tr>
        <th>Measurement outcome</th>
        <th>Probability of outcome</th>
        <th>State after measurement</th>
    </tr>
    <tr>
        <td>$b_i$</td>
        <td>$|c_i|^2$</td>
        <td>$\ket{b_i}$</td>
    </tr>
</table>

<blockquote>
<p>Similar to measurements in single-qubit systems, the assumption of normalization of the original wave function is required in order to ensure that the sum of all the outcome probabilities is 1.</p>
</blockquote>
<h2 id="multi-qubit-measurement-outcome-probabilities-i">Multi-Qubit Measurement Outcome Probabilities I</h2>
<p>Suppose that a two-qubit system is known to be in the following state:
$$\ket \psi =  \frac{1}{3}\ket {00} + \frac{2}{3} \ket {01} + \frac{2}{3}\ket {11}$$</p>
<p>If all the qubits are measured simultaneously in the computational basis, what are the outcome probabilities?</p>
<p>The wave function $|\psi\rangle$ is normalized, since $\left(\frac{1}{3}\right)^2 + \left(\frac{2}{3}\right)^2 + \left(\frac{2}{3}\right)^2 = 1$. Hence, the probabilities of measuring each of the computational basis states is simply the square of the absolute value of the corresponding coefficients. That is, the probabilities of measuring $00$, $01$ and $11$ are $\frac{1}{9}$, $\frac{4}{9}$ and $\frac{4}{9}$, respectively, and the probability of measuring the basis state $10$ that is not part of the superposition is $0$:</p>
<table>
    <tr>
        <th>Measurement outcome</th>
        <th>Probability of outcome</th>
    </tr>
    <tr>
        <td>$00$</td>
        <td>$\left( \frac{1}{3}\right)^2 = \frac{1}{9}$</td>
    </tr> 
    <tr>
        <td>$01$</td>
        <td>$\left( \frac{2}{3}\right)^2 = \frac{4}{9}$</td>
    </tr> 
    <tr>
        <td>$10$</td>
        <td>$\left( 0\right)^2 = 0$</td>
    </tr>     
    <tr>
        <td>$11$</td>
        <td>$\left( \frac{2}{3}\right)^2 = \frac{4}{9}$</td>
    </tr> 
</table>
</details>

<h2 id="multi-qubit-measurement-outcome-probabilities-ii">Multi-Qubit Measurement Outcome Probabilities II</h2>
<p>Suppose that a two-qubit system is known to be in the following state:
$$\ket \psi = \frac{2}{3}\ket {00} + \frac{1}{3} \ket {01} + \frac{2}{3}\ket {11}$$</p>
<p>If all the qubits are measured simultaneously in the Pauli X basis, that is, in the ${ \ket{++}, \ket{+-}, \ket{-+}, \ket{--}}$ basis, what are the outcome probabilities?</p>
<h3 id="analytical-solution">Analytical Solution</h3>
<p>Using the expressions $|0\rangle = \frac{1}{\sqrt{2}} \big( |+\rangle + |-\rangle \big)$ and $|1\rangle = \frac{1}{\sqrt{2}} \big( |+\rangle - |-\rangle \big)$, we first express $|\psi\rangle$ in the Pauli X basis. This gives us
$$\ket \psi =  \frac{2}{3}\ket {00} + \frac{1}{3} \ket {01} + \frac{2}{3}\ket {11}$$</p>
<p>$$= \frac{2}{3} \big[ \frac{1}{\sqrt{2}}\big(\ket{+} + \ket{-}\big) \otimes \frac{1}{\sqrt{2}} \big(\ket{+} + \ket{-}\big) \big] + \frac{1}{3} \big[ \frac{1}{\sqrt{2}}\big(\ket{+} + \ket{-}\big) \otimes \frac{1}{\sqrt{2}} \big(\ket{+} - \ket{-}\big) \big] + \frac{2}{3} \big[ \frac{1}{\sqrt{2}}\big(\ket{+} - \ket{-}\big) \otimes \frac{1}{\sqrt{2}} \big(\ket{+} - \ket{-}\big) \big]$$</p>
<p>$$= \frac{1}{3} \big[ \big(\ket{+} + \ket{-}\big) \otimes \big(\ket{+} + \ket{-}\big) \big] + \frac{1}{6} \big[ \big(\ket{+} + \ket{-}\big) \otimes \big(\ket{+} - \ket{-}\big) \big] + \frac{1}{3} \big[ \big(\ket{+} - \ket{-}\big) \otimes \big(\ket{+} - \ket{-}\big) \big]$$</p>
<p>$$= \frac{1}{3} \big[ \ket{++} + \ket{+-} + \ket{-+} + \ket{--} \big] + \frac{1}{6} \big[ \ket{++} - \ket{+-} + \ket{-+} - \ket{--} \big] + \frac{1}{3} \big[ \ket{++} - \ket{+-} - \ket{-+} + \ket{--} \big]$$</p>
<p>$$= (\frac{1}{3} + \frac{1}{6} + \frac{1}{3})\ket{++} + (\frac{1}{3} - \frac{1}{6} - \frac{1}{3})\ket{+-} + (\frac{1}{3} + \frac{1}{6} - \frac{1}{3})\ket{-+} + (\frac{1}{3} - \frac{1}{6} + \frac{1}{3})\ket{--}$$</p>
<p>$$= \frac{5}{6}\ket{++} - \frac{1}{6}\ket{+-} + \frac{1}{6}\ket{-+} + \frac{1}{2}\ket{--}$$</p>
<p>After this, the probabilities of measuring each of the four basis vectors is given by the square of the absolute value of its amplitude in the superposition:</p>
<table>
    <tr>
        <th>Measurement outcome</th>
        <th>Probability of outcome</th>
    </tr>
    <tr>
        <td>$++$</td>
        <td>$\left( \frac{5}{6}\right)^2 = \frac{25}{36}$</td>
    </tr> 
    <tr>
        <td>$+-$</td>
        <td>$\left( -\frac{1}{6}\right)^2 = \frac{1}{36}$</td>
    </tr> 
    <tr>
        <td>$-+$</td>
        <td>$\left( \frac{1}{6}\right)^2 = \frac{1}{36}$</td>
    </tr>
    <tr>
        <td>$--$</td>
        <td>$\left( \frac{1}{2}\right)^2 = \frac{1}{4}$</td>
    </tr> 
</table>

<h3 id="code-based-solution">Code-Based Solution</h3>
<p>We can also use Q# to solve this problem. It can be achieved in three steps:</p>
<ol>
<li>Prepare the state $\ket \psi$.</li>
<li>Apply a transformation that maps the 2-qubit Pauli X basis into the 2-qubit computational basis. This transformation just applies a Hadamard gate to each of the qubits.</li>
<li>View probabilities of each basis state with the <code>DumpMachine</code> function. Thanks to the previous step, the following state equivalence holds:</li>
</ol>
<table>
    <tr>
        <th>Before basis transformation</th>
        <th>After basis transformation</th>
    </tr>
    <tr>
        <td>$\ket {++}$</td>
        <td>$\ket {00}$</td>
    </tr> 
    <tr>
        <td>$\ket {+-}$</td>
        <td>$\ket {01}$</td>
    </tr> 
    <tr>
        <td>$\ket {-+}$</td>
        <td>$\ket {10}$</td>
    </tr>
    <tr>
        <td>$\ket {--}$</td>
        <td>$\ket {11}$</td>
    </tr> 
</table>

<p>The amplitudes of the computational basis states after the transformation are the same as the amplitudes of the basis states of the Pauli X basis before the transformation!</p>
<blockquote>
<p>To implement the first step, we can represent $\ket \psi$ as<br>$$\frac 2 3 \ket {00} + {\big (} \frac 1 {\sqrt 5} \ket {0} + \frac 2 {\sqrt 5} \ket {1} {\big )} \frac {\sqrt 5} 3 \ket {1}$$
This representation tells us how we should rotate individual qubits.</p>
<p>Notice that we start by rotating the second qubit, as this gives a simpler implementation. If we started by rotating the first qubit, we would need to use a CNOT gate and a controlled $R_y$ gate to achieve the same result.</p>
</blockquote>
